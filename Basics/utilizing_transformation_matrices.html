<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link rel="shortcut icon" type="image/x-icon" href="/webgpuunleashed/favicon.ico">
    <!-- Primary Meta Tags -->
    <title>WebGPU Unleashed: A Practical Tutorial</title>
    <meta name="title" content="WebGPU Unleashed: A Practical Tutorial" />
    <meta name="description" content="WebGPU Unleashed, your ticket to the dynamic world of graphics programming. Dive in and discover the magic of creating stunning visuals from scratch, mastering the art of real-time graphics, and unlocking the power of WebGPU - all in one captivating tutorial." />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://shi-yan.github.io/webgpuunleashed/Basics/utilizing_transformation_matrices.html" />
    <meta property="og:title" content="WebGPU Unleashed: A Practical Tutorial" />
    <meta property="og:description" content="WebGPU Unleashed, your ticket to the dynamic world of graphics programming. Dive in and discover the magic of creating stunning visuals from scratch, mastering the art of real-time graphics, and unlocking the power of WebGPU - all in one captivating tutorial." />
    <meta property="og:image" content="/webgpuunleashed/meta.png" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://shi-yan.github.io/webgpuunleashed/Basics/utilizing_transformation_matrices.html" />
    <meta property="twitter:title" content="WebGPU Unleashed: A Practical Tutorial" />
    <meta property="twitter:description" content="WebGPU Unleashed, your ticket to the dynamic world of graphics programming. Dive in and discover the magic of creating stunning visuals from scratch, mastering the art of real-time graphics, and unlocking the power of WebGPU - all in one captivating tutorial." />
    <meta property="twitter:image" content="/webgpuunleashed/meta.png" />

    <link rel="stylesheet" href="/webgpuunleashed/style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>


    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/base16/default-dark.min.css"
        integrity="sha512-EF2rc4QyBiRAGUMVm+EjFPBbdVGaN/pwZhtuKyrC/dM+hcwTxI5BsEDUkrMRI77z4VlDAt/qVopePXB5+ZZ8Gw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="
        https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js
        "></script>
    <link href="
        https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css
        " rel="stylesheet" />
</head>

<body>
    <div id="menuToggle">
        <input id="menuButton" type="checkbox" />
        <span></span>
        <span></span>
        <span></span>
        <div id="menu-container">
            <ul id="menu">
                <!--<li><a href="#">Home</a></li>
                <li><a href="#">About</a></li>
                <li><a id="test" href="#" onclick="fold(event)">Info</a>
                    <ul class="sub-menu">
                        <li><a href="#">test menu;</a></li>
                        <li><a href="#">test menu;</a></li>
                        <li><a href="#">test menu;</a></li>
                        <li><a href="#">test menu;</a></li>
                    </ul>
                </li>
                <li><a href="#">Contact</a></li>
                <li><a href="https://erikterwan.com/" target="_blank">Show me more</a></li>-->
                <li><a href="https://shi-yan.github.io/webgpuunleashed">Home</a></li>
                <li><a href="#" onclick="fold(event)">Intro</a>
                    <ul class="sub-menu">
                        <li><a href="/webgpuunleashed/Introduction/the_gpu_driver.html">The GPU Driver</a></li>
                        <li><a href="/webgpuunleashed/Introduction/the_gpu_pipeline.html">The GPU Pipeline</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="fold(event)">Basics</a>
                    <ul class="sub-menu">
                        <li><a href="/webgpuunleashed/Basics/creating_an_empty_canvas.html">Creating an Empty Canvas</a></li>
                        <li><a href="/webgpuunleashed/Basics/drawing_a_triangle.html">Drawing a Triangle</a></li>
                        <li><a href="/webgpuunleashed/Basics/drawing_a_triangle_with_defined_vertices.html">Drawing a Triangle with Defined Vertices</a></li>
                        <li><a href="/webgpuunleashed/Basics/applying_hardcoded_vertex_colors.html">Applying Hardcoded Vertex Colors</a></li>
                        <li><a href="/webgpuunleashed/Basics/using_different_vertex_colors.html">Using Different Vertex Colors</a></li>
                        <li><a href="/webgpuunleashed/Basics/drawing_a_colored_triangle_with_a_single_buffer.html">Drawing a Colored Triangle with a Single Buffer</a></li>
                        <li><a href="/webgpuunleashed/Basics/understanding_uniforms.html">Understanding Uniforms</a></li>
                        <li><a href="/webgpuunleashed/Basics/working_with_textures.html">Working with Textures</a></li>
                        <li><a href="/webgpuunleashed/Basics/utilizing_transformation_matrices.html">Utilizing Transformation Matrices</a></li>
                        <li><a href="/webgpuunleashed/Basics/implementing_cameras.html">Implementing Cameras</a></li>
                        <li><a href="/webgpuunleashed/Basics/triangle_strips.html">Triangle Strips</a></li>
                        <li><a href="/webgpuunleashed/Basics/front_and_back_face_culling.html">Front and Back Face Culling</a></li>
                        <li><a href="/webgpuunleashed/Basics/depth_testing.html">Depth Testing</a></li>
                        <li><a href="/webgpuunleashed/Basics/index_buffers.html">Index Buffers</a></li>
                        <li><a href="/webgpuunleashed/Basics/loading_3d_models.html">Loading 3D Models</a></li>
                        <li><a href="/webgpuunleashed/Basics/understanding_normals.html">Understanding Normals</a></li>
                        <li><a href="/webgpuunleashed/Basics/lighting.html">Lighting</a></li>
                        <li><a href="/webgpuunleashed/Basics/multi_sample_anti_aliasing.html">Multi-Sample Anti-Aliasing</a></li>
                        <li><a href="/webgpuunleashed/Basics/mipmapping_and_anisotropic_filtering.html">Mipmapping and Anisotropic Filtering</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="fold(event)">2D Techniques</a>
                    <ul class="sub-menu">
                        <li><a href="/webgpuunleashed/2D_Techniques/rendering_to_textures.html">Rendering to Textures</a></li>
                        <li><a href="/webgpuunleashed/2D_Techniques/orthogonal_cameras.html">Orthogonal Cameras</a></li>
                        <li><a href="/webgpuunleashed/2D_Techniques/implementing_gaussian_blur.html">Implementing Gaussian Blur</a></li>
                        <li><a href="/webgpuunleashed/2D_Techniques/video_rendering.html">Video Rendering</a></li>
                        <li><a href="/webgpuunleashed/2D_Techniques/text_rendering.html">Text Rendering</a></li>
                        <li><a href="/webgpuunleashed/2D_Techniques/billboarding.html">Billboarding</a></li>
                        <li><a href="/webgpuunleashed/2D_Techniques/implementing_fake_3d.html">Implementing Fake 3D</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="fold(event)">Control</a>
                    <ul class="sub-menu">
                        <li><a href="/webgpuunleashed/Control/canvas_resizing.html">Canvas Resizing</a></li>
                        <li><a href="/webgpuunleashed/Control/arcball_camera_control.html">Arcball Camera Control</a></li>
                        <li><a href="/webgpuunleashed/Control/object_picking.html">Object Picking</a></li>
                        <li><a href="/webgpuunleashed/Control/saving_images_and_videos.html">Saving Images and Videos</a></li>
                        <li><a href="/webgpuunleashed/Control/using_web_workers.html">Using Web Workers</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="fold(event)">Compute</a>
                    <ul class="sub-menu">
                        <li><a href="/webgpuunleashed/Compute/prefix_sum.html">Prefix Sum</a></li>
                        <li><a href="/webgpuunleashed/Compute/radix_sort.html">Radix Sort</a></li>
                        <li><a href="/webgpuunleashed/Compute/reaction_diffusion.html">Reaction Diffusion</a></li>
                    </ul>
                </li>
                <li><a href="#" onclick="fold(event)">Advanced</a>
                    <ul class="sub-menu">
                        <li><a href="/webgpuunleashed/Advanced/stencil_buffer.html">Stencil Buffer</a></li>
                        <li><a href="/webgpuunleashed/Advanced/shadow_mapping.html">Shadow Mapping</a></li>
                        <li><a href="/webgpuunleashed/Advanced/toon_shading.html">Toon Shading</a></li>
                        <li><a href="/webgpuunleashed/Advanced/equirectangular_rendering.html">Equirectangular Rendering</a></li>
                        <li><a href="/webgpuunleashed/Advanced/mega_texture.html">Mega Texture</a></li>
                        <li><a href="/webgpuunleashed/Advanced/transparency_with_depth_peeling.html">Transparency with Depth Peeling</a></li>
                        <li><a href="/webgpuunleashed/Advanced/skeleton_animation.html">Skeleton Animation</a></li>
                        <li><a href="/webgpuunleashed/Advanced/gaussian_splatting.html">Gaussian Splatting</a></li>
                    </ul>
                </li>
                <li><a href="https://shi-yan.github.io/webgpuunleashed/code/code.html" target="_blank">Playground</a></li>
                <li><a href="https://github.com/shi-yan/webgpuunleashed" target="_blank">GitHub Repo</a></li>
            </ul>
        </div>
    </div>

    <div id="article-container">
        <article>
            <h2 >1.8 Utilizing Transformation Matrices</h2><p>In this tutorial, we'll revisit our previous shader example to achieve the same result—an offset triangle. However, this time, we'll employ a transformation matrix instead of a simple offset vector. By multiplying our vertex positions with this transformation matrix, we'll produce the same outcome. The key takeaway is that adding an offset vector is equivalent to applying a transformation matrix.</p><a href="https://shi-yan.github.io/webgpuunleashed/code/code.html#1_08_transformation_matrices" target="_blank" class="comment"><svg style="margin-right:10px;vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" height="32"
                    width="32" fill="#dadadb" viewBox="0 -960 960 960"><path d="M189-160q-60 0-102.5-43T42-307q0-9 1-18t3-18l84-336q14-54 57-87.5t98-33.5h390q55 0 98 33.5t57 87.5l84 336q2 9 3.5 18.5T919-306q0 61-43.5 103.5T771-160q-42 0-78-22t-54-60l-28-58q-5-10-15-15t-21-5H385q-11 0-21 5t-15 15l-28 58q-18 38-54 60t-78 22Zm3-80q19 0 34.5-10t23.5-27l28-57q15-31 44-48.5t63-17.5h190q34 0 63 18t45 48l28 57q8 17 23.5 27t34.5 10q28 0 48-18.5t21-46.5q0 1-2-19l-84-335q-7-27-28-44t-49-17H285q-28 0-49.5 17T208-659l-84 335q-2 6-2 18 0 28 20.5 47t49.5 19Zm348-280q17 0 28.5-11.5T580-560q0-17-11.5-28.5T540-600q-17 0-28.5 11.5T500-560q0 17 11.5 28.5T540-520Zm80-80q17 0 28.5-11.5T660-640q0-17-11.5-28.5T620-680q-17 0-28.5 11.5T580-640q0 17 11.5 28.5T620-600Zm0 160q17 0 28.5-11.5T660-480q0-17-11.5-28.5T620-520q-17 0-28.5 11.5T580-480q0 17 11.5 28.5T620-440Zm80-80q17 0 28.5-11.5T740-560q0-17-11.5-28.5T700-600q-17 0-28.5 11.5T660-560q0 17 11.5 28.5T700-520Zm-360 60q13 0 21.5-8.5T370-490v-40h40q13 0 21.5-8.5T440-560q0-13-8.5-21.5T410-590h-40v-40q0-13-8.5-21.5T340-660q-13 0-21.5 8.5T310-630v40h-40q-13 0-21.5 8.5T240-560q0 13 8.5 21.5T270-530h40v40q0 13 8.5 21.5T340-460Zm140-20Z"/></svg>Launch Playground - 1_08_transformation_matrices</a><p>Transformation matrices offer a more versatile way to represent transformations. In practice, we rarely limit ourselves to applying offsets alone. These matrices can handle not just offsetting but also scaling, rotation, and projection. Indeed, transformation matrices are the most generic way of manipulating vertex position. For aspiring graphics developers, a thorough understanding of transformation matrices is crucial—it's an unavoidable aspect of graphics programming.</p><p>If you're new to graphics development, this concept might seem challenging. Let's take a step-by-step approach to make sense of it. We'll start with 2D examples and concrete scenarios. In this tutorial, our focus will be on scaling, translation, and rotation. We'll explore the projection matrix in the next chapter.</p><h3 >Scaling</h3><p>Scaling is the simplest transformation to understand. Imagine we have a 2D vector <code class="language-math math-inline">(x,y)</code>. If we want to scale this vector by a factor of 3, the stretched vector becomes <code class="language-math math-inline">(3x,3y)</code>. We can apply different multipliers to <code class="language-math math-inline">x</code> and <code class="language-math math-inline">y</code>; for instance, using <code class="language-math math-inline">(3,4)</code> would result in <code class="language-math math-inline">(3x,4y)</code>. The equation for 2D scaling is straightforward:</p><p class="katex-display-counter"><code class="language-math math-block">  \begin{aligned}
  x^\prime &= 3 \times x \\
  y^\prime &= 4 \times y \\
  \end{aligned}</code></p><p>We can rewrite this calculation in a less intuitive matrix multiplication form. By the end of this tutorial, you should appreciate why matrices are the preferred way of representing transformations in computer graphics.</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
3 & 0 \\
0 & 4
\end{pmatrix} \times
\begin{pmatrix}
x \\
y
\end{pmatrix} =
\begin{pmatrix}
3x \\
4y
\end{pmatrix}</code></p><p>This calculation extends easily to 3D space:</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
3 & 0 & 0 \\
0 & 4 & 0 \\
0 & 0 & 5
\end{pmatrix} \times
\begin{pmatrix}
x \\
y \\
z
\end{pmatrix} =
\begin{pmatrix}
3x \\
4y \\
5z
\end{pmatrix}</code></p><h3 >Translation</h3><p>Translation is slightly more complex. Let's start with 2D again. If we want to offset a 2D point <code class="language-math math-inline">(x,y)</code> by <code class="language-math math-inline">(3,4)</code>, we calculate the new point as:</p><p class="katex-display-counter"><code class="language-math math-block">  \begin{aligned}
  x^\prime &= 3 + x \\
  y^\prime &= 4 + y \\
  \end{aligned}</code></p><p>Rewriting this as a matrix multiplication isn't immediately obvious. We can attempt it:</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
1 & \frac{3}{y} \\
\frac{4}{x} & 1
\end{pmatrix} \times
\begin{pmatrix}
x \\
y
\end{pmatrix} =
\begin{pmatrix}
x + 3 \\
4 + y
\end{pmatrix}</code></p><p>While this works, it's not ideal because the translation matrix is tied not only to the desired offset but also to the vector <code class="language-math math-inline">(x,y)</code>. Without knowing the vector, we can't derive the translation matrix. This is undesirable in graphics applications, where we want to define a transformation matrix once and apply it to any vertex, creating the same transformation regardless of the vertex's actual position.</p><p>We can employ a clever trick to make the translation matrix depend only on the offset:</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
1 & 0 & 3 \\
0 & 1 & 4 \\
0 & 0 & 1
\end{pmatrix} \times
\begin{pmatrix}
x \\
y \\
1
\end{pmatrix} =
\begin{pmatrix}
x + 3 \\
y + 4 \\
1
\end{pmatrix}</code></p><p>Here, we're expanding the matrix to 3x3, with the offset defined in the last column. We also extend the point location to a 3x1 vector so it can still multiply with the matrix. Now the translation matrix relates only to the offset, and multiplying it with the vector yields <code class="language-math math-inline">(x+3, y+4, 1)</code>, where the first two elements represent the offset 2D point.</p><p>This approach seems to add extra data and calculation, but it creates a matrix with our desired properties. We can also modify the 2D scaling matrix by extending it to 3x3, giving it the same form as the translation matrix.</p><p>Extending this to 3D is straightforward; we simply use a 4x4 matrix:</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
1 & 0 & 0 & 3 \\
0 & 1 & 0 & 4 \\
0 & 0 & 1 & 5 \\
0 & 0 & 0 & 1
\end{pmatrix} \times
\begin{pmatrix}
x \\
y \\
z \\
1
\end{pmatrix} =
\begin{pmatrix}
x + 3 \\
y + 4 \\
z + 5 \\
1
\end{pmatrix}</code></p><h3 >Rotation</h3><p>Rotation is the most challenging transformation to conceptualize. Imagine we have a 2D vector <code class="language-math math-inline">(x,y)</code> that we want to rotate by an angle <code class="language-math math-inline">\theta</code>. Let's first manually calculate the rotation, assuming <code class="language-math math-inline">(x,y)</code> is a unit vector. We'll then consider how to rotate a vector of any length.</p><p><div class="img-container"><img class="img" onclick="openImage(this)" src="thumb_vectorrotation.png" original_src="vectorrotation.png" alt="Rotate a 2D Vector (X,Y) by an Angle Θ" sources='[]' /><div class="img-title">Rotate a 2D Vector (X,Y) by an Angle Θ</div></div></p><p>To rotate the vector by <code class="language-math math-inline">\theta</code>, we can construct a new coordinate system where <code class="language-math math-inline">(x,y)</code> is the <code class="language-math math-inline">x^\prime</code> axis and <code class="language-math math-inline">(-y, x)</code> is the <code class="language-math math-inline">y^\prime</code> axis. In this new system, the rotated vector and the <code class="language-math math-inline">x^\prime</code> axis form an angle <code class="language-math math-inline">\theta</code>.</p><p>The rotated vector's position in the new coordinate system is <code class="language-math math-inline">(cos(\theta)x^\prime, sin(\theta)y^\prime)</code>. Substituting <code class="language-math math-inline">x^\prime</code> with <code class="language-math math-inline">(x,y)</code> and <code class="language-math math-inline">y^\prime</code> with <code class="language-math math-inline">(-y,x)</code>, we get the new vector in the original coordinate system: <code class="language-math math-inline">(cos(\theta)x-sin(\theta)y, cos(\theta)y+sin(\theta)x)</code>.</p><p>We can rewrite this calculation as a matrix multiplication:</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
cos(\theta) & -sin(\theta) \\
sin(\theta) & cos(\theta)
\end{pmatrix} \times
\begin{pmatrix}
x \\
y
\end{pmatrix} =
\begin{pmatrix}
cos(\theta)x - sin(\theta)y\\
sin(\theta)x + cos(\theta)y
\end{pmatrix}</code></p><p>For non-unit vectors, we can normalize by the length <code class="language-math math-inline">l = \sqrt{x^2+y^2}</code>, rotate, and then scale back. You'll find that the rotation matrix is independent of the vector size and only relates to the rotation angle.</p><p>Our goal in rewriting these calculations as matrix multiplications is to unify the form of the calculation. Regardless of the transformation, it can be achieved through matrix multiplication. This allows us to chain multiple transformations easily by multiplying several matrices with a vector. Each matrix represents a transformation, and we can merge a series of transformation matrices into a single matrix through multiplication. This property is crucial for deriving the rotation matrix for 3D space.</p><p>Having derived the rotation matrix for the xy plane, we can easily extend this to the xz and yz planes. Any complex rotation in 3D can be decomposed into a three-step rotation in each plane. Assuming angles <code class="language-math math-inline">\theta_{xy}</code>, <code class="language-math math-inline">\theta_{xz}</code>, and <code class="language-math math-inline">\theta_{yz}</code>, the 3D rotation matrix would be:</p><p class="katex-display-counter"><code class="language-math math-block">\begin{pmatrix}
1 & 0 & 0 \\
0 & cos(\theta_{yz}) & -sin(\theta_{yz}) \\
0 & sin(\theta_{yz}) & cos(\theta_{yz})
\end{pmatrix} \times
\begin{pmatrix}
cos(\theta_{xz}) & 0 & -sin(\theta_{xz}) \\
0 & 1 & 0 \\
sin(\theta_{xz}) & 0 & cos(\theta_{xz})
\end{pmatrix} \times
\begin{pmatrix}
cos(\theta_{xy}) & -sin(\theta_{xy}) & 0 \\
sin(\theta_{xy}) & cos(\theta_{xy}) & 0 \\
0 & 0 & 1
\end{pmatrix}</code></p><p>With these three types of transformation matrices, you can perform almost all transformations except for projection. Perspective projection, for example, makes distant objects appear smaller than closer ones, matching our real-life experience. This deformation can't be achieved solely through rotation, translation, and scaling. We'll explore projection in the next chapter as it's crucial for implementing cameras in 3D graphics.</p><h3 >Homogeneous Coordinates</h3><p>If we only concerned ourselves with scaling and rotation, 3x3 matrices would suffice. However, to include translation, we need to extend the matrices to 4x4 and vectors to 4x1. Recall that in our previous shader code, the vertex shader's position output was always a <code>vec4&lt;f32&gt;</code>, with the fourth element set to 1.0. Now you understand why. These 4D vectors are called homogeneous coordinates. The fourth element isn't always 1; it's 1 for points and 0 for vectors. This distinction is important because vectors, which always start from the origin, can be scaled or rotated but not translated. Setting the fourth element to zero ensures that vectors remain unaffected by translation in any transformation matrix.</p><p>When the fourth element is not 1 or 0, the value is treated as a scaling factor. The actual position of the point can be obtain by <code class="language-math math-inline">(\frac{x}{w},\frac{y}{w},\frac{z}{w})</code>.</p><p>Now that we've introduced transformation matrix theory, let's explore its practical implementation. In addition to transformation matrices, I'll introduce you to a valuable third-party library called glMatrix. While manually creating transformation matrices for 2D points isn't too challenging, it becomes quite tedious for 3D points. This is where glMatrix proves invaluable; it can generate transformation matrices and handle various vector and matrix-related calculations extensively used in computer graphics. We'll rely on this library throughout our journey in this book.</p><div class="code-fragments"><pre><code class="language-javascript code-block" startNumber=11>@group(0) @binding(0)
var&lt;uniform&gt; transform: mat4x4&lt;f32&gt;;
</pre></code><div class="code-fragments-separator">• • •</div><pre><code class="language-javascript code-block" startNumber=17>@vertex
fn vs_main(
    @location(0) inPos: vec3&lt;f32&gt;,
    @location(1) inTexCoords: vec2&lt;f32&gt;
) -&gt; VertexOutput {
    var out: VertexOutput;
    out.clip_position = transform * vec4&lt;f32&gt;(inPos, 1.0);
    out.tex_coords = inTexCoords;
    return out;
}
</pre></code><div class="code-fragments-caption"><a target="_blank" href="https://shi-yan.github.io/webgpuunleashed/code/code.html?highlight=10:11,16:25#1_08_transformation_matrices">1_08_transformation_matrices/index.html:11-26 The Vertex Shader With a Transformation Matrix</a></div></div><p>We've updated our shader code, replacing the <code>vec3</code> uniform called <code>offset</code> with a new uniform named <code>transform</code> of type <code>mat4x4&lt;f32&gt;</code>. This change alters how we calculate the clip position. In the previous version, we added the <code>inPos</code> variable to the <code>offset</code> vector to determine the final position. Now, we achieve this by directly multiplying the <code>inPos</code> vector with the transformation matrix.</p><div class="code-fragments"><pre><code class="language-javascript code-block" startNumber=114>let translateMatrix = glMatrix.mat4.fromTranslation(glMatrix.mat4.create(), glMatrix.vec3.fromValues(-0.5, -0.5, 0.0));

let uniformBuffer = createGPUBuffer(device, translateMatrix, GPUBufferUsage.UNIFORM);
</pre></code><div class="code-fragments-caption"><a target="_blank" href="https://shi-yan.github.io/webgpuunleashed/code/code.html?highlight=113:115#1_08_transformation_matrices">1_08_transformation_matrices/index.html:114-116 Setup the Transformation Matrix Uniform Buffer</a></div></div><p>Let's examine the setup of the uniform buffer. While most of it remains similar, the key difference lies in how we generate the transformation matrix.</p><p>Since our transformation involves only translation, we utilize the glMatrix library's <code>fromTranslation</code> helper function. This library provides a comprehensive set of vectors and matrices utilities of various dimensions, such as <code>vec2</code> and <code>mat4</code>. For each type, it offers numerous functions for performing algebraic calculations or constructing values tailored to our needs. For instance, <code>fromTranslation</code> creates a new matrix based on an offset vector, while <code>fromRotation</code> generates a matrix defining a rotation. Additionally, <code>fromRotationTranslation</code> can produce a matrix combining both rotation and translation.</p><p>If you're accustomed to programming languages other than JavaScript, you might find glMatrix's syntax somewhat verbose. This verbosity primarily stems from JavaScript's lack of operator overloading. However, once you become familiar with glMatrix, this extra verbosity becomes less of an issue.</p><p>For those interested in the generated translation matrix, you can print its values and manually verify that multiplying it with the vertices indeed achieves the desired offset.</p><p>The rest of the code remains largely unchanged. We create a uniform buffer and copy the internal values of the translation matrix (16 floats) into this buffer using our convenient helper function <code>createGPUBuffer</code>.</p><p>Upon running the code, you'll observe the same offset triangle. Challenge yourself by deriving different translation matrices by altering the input of the <code>fromTranslation</code> function. You can also experiment with the <code>fromRotationTranslation</code> function to see if you can rotate the triangle as well.</p><p>While the sample code in this chapter is relatively basic, the key focus lies on understanding the transformation matrix. In subsequent chapters, you'll find this concept being applied extensively across various scenarios.</p>
        </article>

        <div class="older_newer_link_section">
            <div class="older_newer_link_left">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" height="12" width="11" fill="#dadadb"
                        viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" />
                    </svg>
                    PREV POST
                </p>
                <p>
                    <a class="older_newer_link" href="/webgpuunleashed/Basics/working_with_textures.html">Working with Textures</a>
                </p>
            </div>

            <div class="older_newer_link_right">
                <p>
                    NEXT POST
                    <svg xmlns="http://www.w3.org/2000/svg" height="12" width="11" fill="#dadadb"
                        viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z" />
                    </svg>
                </p>
                <p>
                    <a class="older_newer_link" href="/webgpuunleashed/Basics/implementing_cameras.html">Implementing Cameras</a>
                </p>
            </div>
        </div>

        <a href="https://github.com/shi-yan/webgpuunleashed/discussions" target="_blank" class="comment"><svg
            style="margin-right:10px;vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" height="32"
            width="32" fill="#dadadb"
            viewBox="0 0 480 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
            <path
                d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z" />
        </svg> Leave a Comment on Github</a>
    </div>
    <!-- The Modal -->
    <div id="img-modal" class="modal">
        <!-- The Close Button -->
        <span class="close" id="img-close">&times;</span>
        <!-- Modal Content (The Image) -->
        <img class="modal-content" id="img01">

        <!-- Modal Caption (Image Text) -->
        <div id="caption"></div>
    </div>
    <script>
        function fold(e) {
            const sub = e.currentTarget.parentElement.getElementsByTagName("ul")[0];
            console.log("sub", e.currentTarget, sub);
            if (sub.style.display === "block") {
                sub.style.display = "none";
            } else {
                sub.style.display = "block";
            }
        }
    
        window.addEventListener('click', (e) => {
           // const sub = e.currentTarget.parentElement.getElementsByTagName("ul")[0];
            document.getElementById("menuButton").checked = false;
        });
    
        document.getElementById("menu-container").addEventListener('click',(event) => {
            event.stopPropagation();
        });

        document.getElementById("menuButton").addEventListener('click', (event) => {
            event.stopPropagation();
        });
       
        function openImage(img) {
            let modal = document.getElementById("img-modal");
            let modalImg = document.getElementById("img01");
            modal.style.display = "block";
            if (img.getAttribute("original_src")) {
                modalImg.src = img.getAttribute("original_src");
            } else {
                modalImg.src = img.src;
            }
            let captionText = document.getElementById("caption");

            captionText.innerText = img.alt;

            let sources = JSON.parse(img.getAttribute("sources"));

            for (let i = 0; i < sources.length; ++i) {
                if (sources.length == 1) {
                    captionText.innerHTML += "<a href='" + sources[i] + "' target='_blank' class='img-source'>SOURCE</a>";
                } else {
                    captionText.innerHTML += "<a href='" + sources[i] + "' target='_blank' class='img-source'>SOURCE " + (i + 1) + "</a>";
                }
            }
        }
        // Get the <span> element that closes the modal
        var closeButton = document.getElementById("img-close");

        // When the user clicks on <span> (x), close the modal
        closeButton.onclick = function () {
            var modal = document.getElementById("img-modal");
            modal.style.display = "none";
        }
    </script>

    <script type="module">
        const macros = {};
        const mathElementsBlock = document.getElementsByClassName("math-block");
        for (let element of mathElementsBlock) {
            katex.render(element.textContent, element, {
                throwOnError: false,
                displayMode: true,
                macros
            });
        }

        const mathElementsInline = document.getElementsByClassName("math-inline");
        for (let element of mathElementsInline) {
            katex.render(element.textContent, element, {
                throwOnError: false,
                macros
            });
        }

        hljs.highlightAll();
        // hljs.initLineNumbersOnLoad();
        const codeBlocks = document.getElementsByClassName("code-block");
        for (let i = 0; i < codeBlocks.length; ++i) {
            if (codeBlocks[i].hasAttribute("startnumber")) {
                const startFrom = codeBlocks[i].getAttribute("startnumber");
                hljs.lineNumbersBlock(codeBlocks[i], { startFrom: parseInt(startFrom, 10) });
            } else {
                hljs.lineNumbersBlock(codeBlocks[i]);
            }
        }

    </script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G278P1YSJ6"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag('js', new Date());
gtag('config', 'G-G278P1YSJ6');
</script>
</body>

</html>